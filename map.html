<!DOCTYPE html>
<html>
  <head>
    <title>Drawing tools</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
      .custom-button {
        padding: 10px;
        background-color: white;
      }
      .custom-button:hover {
        border: 2px black;
        background-color: #DFDFDF;
      }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=drawing"></script>
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
    <script>
      function initialize() {

        var vector = new function() {
          this.markers = []; 
          this.polylines = []; 
          this.polygons = []; 
          this.rectangles = []; 
          this.circles  = [];
        }

      /* Custom Reggie icon */
        var image = {
          url: 'images/reggie.png',
          size: new google.maps.Size(20, 27),
          origin: new google.maps.Point(0,0),
          anchor: new google.maps.Point(8, 27)
        };

      /* Center map on ISU campus */
        var mapOptions = {
          center: new google.maps.LatLng(40.508297, -88.991114),
          zoom: 17,
          disableDefaultUI: true
        };

      /* Initialize map */
        var map = new google.maps.Map(document.getElementById('map-canvas'),
          mapOptions);

        var drawingManager = new google.maps.drawing.DrawingManager({
          drawingMode: google.maps.drawing.OverlayType.MARKER,
          drawingControl: false,
          markerOptions: {
            icon: image,
            draggable: true
          },
          circleOptions: {
            fillColor: '#ffff00',
            fillOpacity: 1,
            strokeWeight: 5,
            clickable: false,
            editable: true,
            zIndex: 1
          },
          polygonOptions: {
            editable: true
          },
          polylineOptions: {
            editable: true
          },
          rectangleOptions: {
            editable: true
          }
        });

        drawingManager.setMap(map);

      // *****************************************
      // Get paths for every edited map vector
      // *****************************************

        google.maps.event.addDomListener(drawingManager, 'markercomplete', function(marker) {
          vector.markers.push(marker);
        });
        google.maps.event.addDomListener(drawingManager, 'polylinecomplete', function(polyline) {
          vector.polylines.push(polyline);
          drawingManager.setDrawingMode(null);
        });
        google.maps.event.addDomListener(drawingManager, 'polygoncomplete', function(polygon) {
          vector.polygons.push(polygon);
          drawingManager.setDrawingMode(null);
        });
        google.maps.event.addDomListener(drawingManager, 'rectanglecomplete', function(rectangle) {
          vector.rectangles.push(rectangle);
          drawingManager.setDrawingMode(null);
        });
        google.maps.event.addDomListener(drawingManager, 'circlecomplete', function(circle) {
          vector.circles.push(circle);
          drawingManager.setDrawingMode(null);
        });

      // *****************************************
      // Custom Buttons
      // *****************************************

      var customButtons = [
        { "name":"export",    "object": document.createElement('div') },
        { "name":"move",      "object": document.createElement('div') }, 
        { "name":"marker",    "object": document.createElement('div') },
        { "name":"polyline",  "object": document.createElement('div') },
        { "name":"polygon",   "object": document.createElement('div') },
        { "name":"rectangle", "object": document.createElement('div') },
        { "name":"circle",    "object": document.createElement('div') }
        ];

        var controlDiv = document.createElement('div');
        controlDiv.style.padding = '5px';

      for ( var obj in customButtons ) {
        var control = customButtons[obj].object;
        var name = customButtons[obj].name;
        control.className = "custom-button " + name;
        control.style.cursor = 'pointer';
        control.title = 'Click to export map JSON data';
        controlDiv.appendChild(control);

        var controlText = document.createElement('div');
        controlText.innerHTML = '<strong>' + name + '</strong>';
        control.appendChild(controlText);
      }

      // *****************************************
      // Custom Events
      // *****************************************

      // Export JSON
        google.maps.event.addDomListener(customButtons[0].object, 'click', function() {
          var vectorData = "map : [ \n";

          if ( vector.markers.length !=0 ) {
            vectorData = vectorData + "\t markers : [ \n";
            for ( var i=0; i < vector.markers.length; i++ ){
              vectorData = vectorData + "\t\t marker_" + i + " : [ \n";
              vectorData = vectorData + "\t\t position : " + vector.markers[i].getPosition().toString() + " ]";
              if ( i != vector.markers.length - 1 ) {
                vectorData = vectorData + ", \n";
              }
            }
            vectorData = vectorData + "\n\t ] \n";
          }
          if ( vector.polylines.length !=0 ) {
            vectorData = vectorData + "polylines : [ ";
            for ( var i=0; i < vector.markers.length; i++ ){
              vectorData = vectorData + "polyline_" + i + " : [ ";
              vectorData = vectorData + vector.markers[i].getPosition().toString() + "\n";
            }
          }
          if ( vector.polygons.length !=0 ) {
            vectorData = vectorData + "polygons : [ ";
            for ( var i=0; i < vector.markers.length; i++ ){
              vectorData = vectorData + "polygon_" + i + " : [ ";
              vectorData = vectorData + vector.markers[i].getPosition().toString() + "\n";
            }
          }
          if ( vector.rectangles.length !=0 ) {
            vectorData = vectorData + "\t rectangles : [ \n";
            for ( var i=0; i < vector.rectangles.length; i++ ){
              vectorData = vectorData + "\t\t rectangle" + i + " : [ \n";
              vectorData = vectorData + "\t\t bounds : " + vector.rectangles[i].getBounds().toString() + " ]";
              if ( i != vector.rectangles.length - 1 ) {
                vectorData = vectorData + ", \n";
              }
            }
            vectorData = vectorData + "\n\t ] \n";
          }
          if ( vector.circles.length !=0 ) {
            vectorData = vectorData + "\t circles : [ \n";
            for ( var i=0; i < vector.circles.length; i++ ){
              vectorData = vectorData + "circle_" + i + " : [ \n";
              vectorData = vectorData + "center : " + vector.circles[i].getCenter().toString() + "," +
                                        "radius : " + vector.circles[i].getRadius().toString() + "\n";
              vectorData = vectorData + "]]";
            }
          }
          vectorData = vectorData + "]";
          alert( vectorData );
        });

      // Select Move 
        google.maps.event.addDomListener(customButtons[1].object, 'click', function() {
          drawingManager.setDrawingMode(null);
        });
      // Select Marker
        google.maps.event.addDomListener(customButtons[2].object, 'click', function() {
          drawingManager.setDrawingMode(google.maps.drawing.OverlayType.MARKER);
        });
      // Select Polyline
        google.maps.event.addDomListener(customButtons[3].object, 'click', function() {
          drawingManager.setDrawingMode(google.maps.drawing.OverlayType.POLYLINE);
        });
        // Select Polygon
        google.maps.event.addDomListener(customButtons[4].object, 'click', function() {
          drawingManager.setDrawingMode(google.maps.drawing.OverlayType.POLYGON);
        });
        // Select Rectangle
        google.maps.event.addDomListener(customButtons[5].object, 'click', function() {
          drawingManager.setDrawingMode(google.maps.drawing.OverlayType.RECTANGLE);
        });
        // Select Circle
        google.maps.event.addDomListener(customButtons[6].object, 'click', function() {
          drawingManager.setDrawingMode(google.maps.drawing.OverlayType.CIRCLE);
        });


        controlDiv.index = 1;
        map.controls[google.maps.ControlPosition.TOP_RIGHT].push(controlDiv);
      }

      google.maps.event.addDomListener(window, 'load', initialize);
    </script>

    <script>
      $( window ).load( function() {
        $( ".custom-button" ).on( 'click', function(e) {
          e.preventDefault();
          alert( "Hola" );
          $( ".custom-button" ).removeClass("active");
          $( this ).addClass("active");
        });
      });
    </script>

  </head>
  <body>
    <div id="map-canvas"></div>
  </body>
</html>